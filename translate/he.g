#  File converted from Magma code -- requires editing and checking
#  Magma -> GAP converter, version 0.43, 4/04/16 by AH

#  Global Variables used: Append, Centraliser, Centre, FPGroupStrong,
#  Generators, Id, Index, IsConjugate, Ngens, Normaliser, Order, Random, Socle,
#  Stabiliser, Sylow, Sym

#  Defines: HeIdentify

DeclareGlobalFunction("HeIdentify@");

#   Code for maximal subgroups of He, He.2 
InstallGlobalFunction(HeIdentify@,
function(group)
#  /out: group should be already known to be isomorphic to He or He.2
local 
   CG,F,N7,NE7,Print,S,S2,S3,S7,ZS7,a,ag,aut,b,bg,c,ce,d,g,group,h,he,he2,homom,
   i,ims,isc,j,max,maximals,newgens,phi,soc,zg,zgc;
  max:=ValueOption("max");
  if max=fail then
    max:=true;
  fi;
  Print:=ValueOption("Print");
  if Print=fail then
    Print:=0;
  fi;
  if Print > 1 then
    Print("Making standard group");
  fi;
  #  use generators of He.2 from Rob Wilson's online ATLAS
  c:=(1,948)(2,1170)(3,1548)(4,452)(5,1896)(6,2028)(7,1332)(8,1457)(9,1430)
   (10,160)(11,981)(12,1826)(13,1644)(14,815)(15,1275)(16,1220)(17,185)(18,1446)
   (19,356)(20,1004)(21,458)(22,983)(23,462)(24,839)(25,698)(26,565)(27,612)
   (28,2000)(29,1377)(30,336)(31,370)(32,183)(33,242)(34,459)(35,2052)(36,1169)
   (37,1310)(38,1783)(39,2046)(40,877)(41,1773)(42,1800)(43,1882)(44,255)
   (45,810)(46,608)(47,595)(48,763)(49,144)(50,337)(51,1908)(52,1397)(53,368)
   (54,355)(55,1283)(56,431)(57,611)(58,1560)(59,1610)(60,231)(61,1342)(62,794)
   (63,374)(64,888)(65,1380)(66,393)(67,1854)(68,814)(69,480)(70,868)(72,1928)
   (73,436)(74,2058)(75,150)(76,396)(77,909)(78,1952)(79,653)(80,1497)(81,889)
   (82,2001)(83,1391)(84,1471)(85,559)(86,969)(87,148)(88,1327)(89,1165)
   (90,1274)(92,1264)(93,1164)(94,501)(95,1939)(96,1792)(97,195)(98,1227)
   (99,904)(100,1805)(101,1756)(102,416)(103,348)(104,1440)(105,420)(106,1085)
   (107,206)(108,690)(109,746)(110,1042)(111,1030)(112,1678)(113,1999)(114,1196)
   (115,1365)(116,1522)(117,346)(118,1155)(119,1745)(120,1379)(121,1412)
   (122,1053)(123,1526)(124,1696)(125,1039)(126,830)(127,219)(128,695)(129,1619)
   (130,1817)(131,173)(132,1371)(133,1574)(134,199)(135,1565)(136,1547)
   (137,1530)(138,1387)(139,1070)(140,745)(141,1905)(142,299)(143,1571)(145,781)
   (146,1364)(147,837)(149,774)(151,1318)(152,292)(153,802)(154,1725)(155,833)
   (156,1110)(157,497)(158,1995)(159,1614)(161,1746)(162,1580)(163,1153)
   (164,800)(165,510)(166,788)(167,691)(168,616)(169,582)(170,1072)(171,192)
   (172,1290)(174,1724)(175,345)(176,516)(177,1816)(178,1689)(179,714)(180,331)
   (181,929)(182,994)(184,584)(186,701)(187,406)(188,1918)(189,1561)(190,1144)
   (191,2027)(193,2002)(194,792)(196,400)(197,631)(198,1972)(200,1054)(202,402)
   (203,1182)(204,1570)(205,1032)(207,1294)(208,1609)(209,359)(210,1973)
   (211,1961)(212,1131)(213,599)(214,1393)(215,1292)(216,1158)(217,1741)
   (218,1553)(220,335)(221,1267)(222,1978)(223,1311)(224,415)(225,689)(226,451)
   (227,790)(228,562)(229,1658)(230,1748)(232,386)(233,1693)(234,1793)(235,915)
   (236,1979)(237,1708)(238,287)(239,410)(240,797)(241,887)(243,738)(244,1411)
   (245,1768)(246,1968)(247,514)(248,1350)(249,972)(250,2051)(251,567)(252,2024)
   (253,759)(254,322)(256,2047)(257,1772)(258,533)(259,683)(260,1621)(261,558)
   (262,2045)(263,775)(264,641)(265,1026)(266,428)(267,2048)(268,1747)(269,1998)
   (270,986)(271,315)(272,1074)(273,615)(274,279)(275,1019)(276,951)(277,1388)
   (278,865)(280,369)(281,580)(282,1444)(283,1640)(284,594)(285,1142)(286,1963)
   (288,753)(289,1672)(290,316)(291,1496)(293,902)(294,342)(295,413)(296,364)
   (297,740)(298,1389)(300,1585)(301,519)(302,1328)(303,1495)(304,2053)(305,729)
   (306,1776)(307,1763)(308,932)(309,1605)(310,579)(312,2030)(313,1942)
   (314,1712)(317,546)(318,2025)(319,2020)(320,966)(321,1832)(323,378)(324,757)
   (325,1997)(326,468)(327,962)(328,1962)(329,1931)(330,1851)(332,1684)(333,667)
   (334,1633)(338,477)(339,676)(340,1096)(341,1930)(343,1163)(344,433)(347,1354)
   (349,1124)(350,484)(351,1956)(352,1112)(353,1652)(354,1249)(357,1802)
   (358,409)(360,623)(361,898)(363,629)(365,968)(366,566)(367,1903)(371,776)
   (372,1456)(373,630)(375,1731)(376,1181)(377,1246)(379,1821)(380,1145)
   (381,395)(382,841)(383,789)(384,1092)(385,992)(387,637)(389,905)(390,1154)
   (391,1664)(392,1820)(394,835)(397,1698)(398,1871)(399,577)(401,1739)
   (403,1276)(404,1581)(405,528)(407,450)(408,1146)(411,2039)(412,1669)
   (414,1936)(417,692)(418,434)(419,1685)(421,831)(422,696)(423,732)(424,953)
   (425,592)(426,852)(427,2016)(429,1509)(430,1151)(432,1813)(435,779)(437,998)
   (438,977)(439,1552)(440,1252)(441,974)(442,1409)(443,770)(444,1790)(445,482)
   (446,762)(447,1117)(448,1347)(449,1723)(453,1325)(454,1404)(455,2056)
   (456,1659)(457,873)(460,491)(461,1062)(463,1738)(464,1937)(466,1184)(467,619)
   (469,571)(470,1611)(471,1697)(472,734)(473,1000)(474,913)(475,485)(476,764)
   (478,2005)(479,1914)(481,945)(483,1587)(486,1540)(487,1016)(488,1066)
   (489,1982)(490,541)(492,1884)(493,1926)(494,643)(495,1162)(496,1874)
   (498,1663)(499,587)(500,1183)(502,1180)(503,1683)(504,1431)(505,681)
   (506,1617)(507,1277)(508,1139)(509,1258)(511,1349)(512,950)(513,2004)
   (515,1706)(517,712)(518,1134)(520,1001)(521,1986)(522,1003)(523,704)
   (524,1272)(525,1230)(526,1750)(527,1779)(529,1396)(530,984)(531,1352)
   (532,1189)(534,1394)(535,1867)(536,1287)(537,1824)(538,851)(539,1278)
   (540,1898)(542,1953)(543,1329)(544,1726)(545,1398)(547,1807)(548,1438)
   (549,1244)(550,1710)(551,1171)(552,1470)(553,1798)(554,604)(555,964)
   (556,1733)(557,607)(560,1222)(561,581)(563,817)(564,766)(568,1517)(569,939)
   (570,1024)(572,1559)(573,644)(574,1734)(575,798)(576,1675)(578,773)(583,1279)
   (585,1122)(586,1558)(588,1876)(589,914)(590,602)(591,1250)(596,1912)
   (597,1356)(598,1504)(600,1432)(601,1964)(603,1834)(605,1047)(606,1897)
   (609,895)(610,796)(614,710)(617,1031)(618,1195)(620,1970)(621,1916)(622,995)
   (624,2012)(625,1208)(626,1402)(627,1395)(628,980)(632,855)(633,648)(635,1298)
   (636,1622)(638,834)(639,651)(642,1687)(646,1116)(647,1804)(649,996)(650,1935)
   (654,1556)(655,1701)(656,688)(657,1862)(658,1626)(659,1009)(660,1455)
   (661,1451)(662,1643)(664,922)(665,735)(666,919)(668,1452)(669,1123)(670,2019)
   (671,1777)(672,1949)(673,723)(674,1539)(675,1555)(677,827)(678,711)(679,1544)
   (680,1523)(682,1382)(684,891)(685,1880)(686,1516)(687,1812)(693,780)
   (694,1934)(697,1138)(699,1550)(700,1582)(702,1839)(703,1345)(705,1185)
   (706,1473)(707,721)(708,1323)(713,1563)(715,843)(716,906)(717,1336)(718,1638)
   (719,1161)(720,1925)(722,1902)(724,927)(725,1646)(727,1618)(728,739)
   (730,1754)(731,1486)(733,1045)(736,1778)(737,1657)(741,777)(742,1564)
   (743,1814)(744,1207)(747,2006)(748,1035)(749,872)(750,1493)(751,957)(752,924)
   (754,1419)(755,1796)(756,1525)(758,1943)(760,1449)(761,1237)(767,1993)
   (768,1682)(769,1527)(771,1647)(772,1607)(778,1462)(782,1315)(784,1210)
   (785,1015)(786,848)(787,1688)(791,1076)(793,1008)(795,1729)(799,1780)
   (801,1960)(803,967)(804,1891)(806,1106)(807,942)(808,1410)(809,1370)
   (811,1515)(812,2029)(813,1503)(816,1744)(818,874)(819,1240)(820,1476)
   (821,1055)(822,988)(823,931)(824,1828)(825,1187)(826,1193)(828,1786)
   (829,1025)(832,1257)(836,1468)(838,1848)(840,1160)(842,1850)(844,1301)
   (845,1849)(846,1135)(847,1740)(849,971)(850,1795)(853,1629)(854,1100)
   (856,1506)(857,1915)(858,917)(860,1460)(861,1599)(862,1886)(863,886)
   (864,1819)(866,1857)(867,1384)(869,1864)(870,1028)(871,1483)(875,1642)
   (876,1469)(879,1385)(880,1554)(881,2037)(882,1406)(883,1594)(884,1730)
   (885,1104)(890,1994)(892,1781)(893,1751)(894,1174)(896,1500)(897,1579)
   (899,1690)(900,940)(901,1428)(903,991)(907,1492)(908,1612)(910,1416)
   (911,1542)(912,1873)(916,1568)(918,1840)(920,1648)(921,1424)(923,1573)
   (925,1679)(926,1102)(928,1061)(930,1762)(933,1911)(934,1022)(935,1910)
   (936,1023)(937,1485)(938,1198)(941,2010)(943,1709)(944,1309)(946,1458)
   (947,1041)(949,978)(952,973)(954,2041)(955,1261)(956,1590)(958,975)(959,1736)
   (960,2036)(961,1149)(963,1461)(965,1288)(970,1668)(976,1920)(979,1040)
   (982,1190)(985,1883)(987,1655)(990,1226)(993,1860)(997,1073)(1002,1545)
   (1005,1707)(1006,1990)(1007,2042)(1010,1660)(1012,1484)(1013,1148)(1014,1050)
   (1017,1091)(1018,1150)(1020,1270)(1021,1282)(1027,1680)(1029,1390)(1033,1907)
   (1034,1653)(1036,1799)(1037,1200)(1038,1732)(1043,1988)(1044,1401)(1046,1103)
   (1048,1877)(1049,1721)(1051,1465)(1052,1809)(1056,1917)(1057,1719)(1058,1948)
   (1059,1632)(1060,1260)(1064,2011)(1065,1067)(1068,1368)(1069,1344)(1071,1666)
   (1075,1616)(1077,1806)(1078,2049)(1080,1922)(1081,1268)(1082,1505)(1083,1316)
   (1086,1362)(1087,1649)(1088,1625)(1089,1856)(1090,1870)(1093,1989)(1094,1304)
   (1095,2038)(1097,1293)(1098,1578)(1099,1767)(1101,1940)(1105,1201)(1107,1512)
   (1108,1118)(1109,1784)(1111,1727)(1113,1641)(1114,1620)(1115,1223)(1119,1869)
   (1120,1337)(1121,1176)(1125,1437)(1126,1977)(1127,1645)(1128,1212)(1129,1829)
   (1130,2035)(1132,1156)(1133,1686)(1136,1691)(1137,1711)(1140,1794)(1141,1265)
   (1143,1815)(1147,1373)(1152,1172)(1157,1245)(1159,1359)(1166,1296)(1167,1312)
   (1168,1339)(1173,1417)(1175,1613)(1177,1636)(1178,1742)(1179,1353)(1186,2040)
   (1188,1538)(1191,1330)(1192,1414)(1194,1346)(1197,1305)(1199,1904)(1202,1224)
   (1203,1482)(1204,1232)(1205,1855)(1206,2026)(1209,2023)(1211,1494)(1213,1955)
   (1214,1803)(1215,1881)(1216,1514)(1217,1662)(1218,1403)(1219,1674)(1221,1787)
   (1225,1381)(1228,1420)(1229,1608)(1231,2018)(1233,1255)(1234,1984)(1235,1475)
   (1236,1866)(1238,1761)(1239,1667)(1241,1322)(1242,1835)(1247,1774)(1248,1306)
   (1253,1577)(1254,1490)(1256,1343)(1259,1320)(1262,1314)(1263,1965)(1266,1427)
   (1269,1284)(1271,1958)(1273,1341)(1280,2007)(1281,1423)(1285,1875)(1286,1453)
   (1289,1562)(1291,1909)(1295,1946)(1297,2003)(1299,1695)(1300,1899)(1302,1631)
   (1303,1760)(1307,1546)(1308,1985)(1317,2015)(1319,1827)(1324,1447)(1326,1789)
   (1331,1480)(1333,1906)(1334,1852)(1335,1954)(1338,1635)(1340,1597)(1348,1703)
   (1351,1595)(1355,1743)(1357,1755)(1358,1533)(1360,1534)(1361,1681)(1363,1900)
   (1366,1714)(1367,1650)(1369,1811)(1374,1843)(1375,1717)(1376,1771)(1378,1888)
   (1383,1923)(1392,1700)(1399,1589)(1400,1439)(1405,1677)(1407,1969)(1408,1627)
   (1413,1966)(1415,1491)(1418,1477)(1421,1863)(1422,1535)(1425,1598)(1426,1992)
   (1429,2021)(1433,2013)(1434,1810)(1435,1735)(1436,1889)(1441,1464)(1442,1782)
   (1443,1853)(1445,1878)(1448,1634)(1450,1584)(1454,1728)(1459,1474)(1466,1737)
   (1467,1764)(1472,1975)(1478,1887)(1479,1665)(1481,2043)(1487,1624)(1488,1818)
   (1489,1715)(1498,1702)(1499,1511)(1501,1583)(1502,1603)(1507,1844)(1508,1524)
   (1510,1591)(1513,1822)(1518,2033)(1519,1600)(1520,1892)(1521,1951)(1528,1823)
   (1529,1947)(1531,1705)(1532,1566)(1536,1551)(1537,1929)(1541,1841)(1543,2031)
   (1549,1830)(1557,1628)(1567,1765)(1569,1753)(1572,1752)(1575,1801)(1576,1588)
   (1586,1838)(1592,1692)(1593,2044)(1596,1808)(1601,1623)(1602,1670)(1606,1699)
   (1630,2022)(1637,1957)(1639,1859)(1654,1865)(1656,1894)(1661,2008)(1671,1893)
   (1673,1938)(1676,1718)(1694,1919)(1704,1981)(1713,1932)(1716,1944)(1720,2055)
   (1722,1950)(1749,1974)(1757,1996)(1758,1846)(1759,1797)(1766,1775)(1769,1890)
   (1785,1837)(1788,2017)(1791,1991)(1825,1980)(1831,2034)(1836,1933)(1842,1971)
   (1847,1967)(1858,2009)(1861,1941)(1872,1879)(1885,2014)(1895,2057)(1901,1983)
   (1913,2054)(1921,1924)(1927,1945)(1976,2032)(1987,2050) #CAST 
   SymmetricGroup(2058)
    ;
  d:=(1,853,45,1836,1602,920)(2,1176,898,226,668,1301)(3,933,1449,995,808,4)
   (5,591,343,1069,1139,1403)(6,914,802,277,999,1910)(7,1917,1979,620,250,604)
   (8,798,227,953,1518,172)(9,403,263,633,1606,1371)(10,813)
   (11,752,1828,1246,314,251)(12,1263,283,1080,1308,710)
   (13,1686,753,146,570,575)(14,136,1856,490,1429,1676)(15,215,676,426,391,1097)
   (16,1044,680,718,875,1289)(17,1362,1978,71,1177,337)(18,466,1014,611,764,650)
   (19,469,1579,728,1654,1359)(20,674,1253,2048,1807,258)
   (21,234,563,1256,1317,360)(22,1391,1951,367,699,973)(23,1279)
   (24,780,1001,1948,1400,1028)(25,336,1140,342,372,1727)
   (26,2042,1381,757,1423,893)(27,1311,1734,1405,1195,1849)
   (28,1193,376,1598,177,1848)(29,292,540,1568,660,44)(30,170,72,1493,1779,1675)
   (31,760,1169,1349,686,538)(32,95,937,766,496,826)(33,842,996,1651,244,695)
   (34,874,1835,503,274,1761)(35,935,793,1888,981,1363)(36,164,189,455,76,1481)
   (37,142,1338,1846,1809,1275)(38,345,1692,539,419,1084)
   (39,574,147,1588,1960,1051)(40,546,1023,1577,1036,450)
   (41,420,1073,84,830,737)(42,219,1021,724,1067,1389)(43,154,1189,433,725,1701)
   (46,120,1420,742,1235,297)(47,52,671,254,1562,1383)(48,863,1340,199,1895,446)
   (49,1546)(50,70,985,1310,993,1626)(51,449,1009,859,191,1428)
   (53,1943,1843,533,309,1650)(54,183,776,1460,434,58)(55,845,83,2012,1115,1932)
   (56,1476,1877,661,642,61)(57,428,62,2058,577,1924)(59,729,1946,390,644,1090)
   (60,138,1118,2053,499,1724)(63,106,1110,528,221,280)
   (64,351,1488,1414,637,1401)(65,957)(66,1415,107,427,1674,727)
   (67,1332,1921,1266,160,173)(68,87,279,767,155,143)
   (69,1234,1535,1994,1241,113)(73,1335,622,1804,2007,2043)
   (74,1818,346,2006,150,636)(75,1552,1426,267,1229,1892)
   (77,452,1211,1146,187,1120)(78,378,809,1992,1133,208)
   (79,137,510,1479,1620,1526)(80,485,1204,515,605,596)
   (81,794,1780,910,2005,144)(82,1942,1173,2036,1424,1452)
   (85,206,1121,869,824,1220)(86,1005,690,1422,960,194)
   (88,1923,544,225,1252,497)(89,475,186,1477,1933,607)
   (90,487,702,1850,1012,559)(91,437,1167,1556,1024,980)
   (92,1662,340,185,241,1427)(93,323,1119,402,370,629)
   (94,1365,421,1083,1881,296)(96,264,100,851,1396,1998)
   (97,1344,411,1653,820,770)(98,1048,714,365,2029,361)
   (99,167,1482,1884,1469,1860)(101,1312,1367,394,1603,2000)
   (102,1394,1643,1210,488,555)(103,1703,1854,1887,1666,1062)
   (104,1713,1627,740,909,831)(105,774,1352,1309,1320,1017)
   (108,1321,1523,984,1663,1554)(109,1670,1929,1996,2013,730)
   (110,1018,1043,1798,1614,833)(111,354,685,572,1196,619)
   (112,1778,872,1774,1885,341)(114,409,1457,1392,1047,1122)
   (115,1672,306,1615,1333,646)(116,839,1759,339,979,778)
   (117,1128,1038,1521,931,997)(118,1413,468,1763,1395,375)
   (119,1824,748,645,1538,791)(121,1292,397,651,1215,743)
   (122,1871,2003,886,1287,261)(123,895,1022,621,531,1072)
   (124,654,1944,1894,1078,1563)(125,1483,1542,200,785,1095)
   (126,1581,1918,584,763,1075)(127,692,1723,747,941,1066)
   (128,1285,1964,803,353,1261)(129,1806,879,1492,1326,1624)
   (130,1284,806,659,1277,302)(131,1354,1621,247,1112,163)
   (132,812,1348,236,924,1800)(133,444,1608,1006,1374,1660)
   (134,2004,822,2039,256,578)(135,758,1753,561,603,1766)
   (139,141,919,970,1339,987)(140,332,844,1912,841,246)
   (145,643,1510,678,1874,837)(148,1878,287,1796,1545,422)
   (149,158,505,670,1447,1299)(151,1101,683,754,1170,239)
   (152,1103,1450,1512,1511,1642)(153,1704,377,1781,291,1219)
   (156,2054,1366,1141,669,554)(157,821,1443,1558,825,290)
   (159,715,224,988,1956,1745)(161,2040,594,887,529,1361)
   (162,1430,1973,1187,1325,936)(165,624,1544,1969,1154,2035)
   (166,532,1200,371,704,1107)(168,534,1925,1679,861,592)
   (169,1166,1867,320,1613,846)(171,1487,350,218,349,688)
   (174,1540,1517,1142,918,1731)(175,1015,871,1468,459,1886)
   (176,1749,304,772,281,382)(178,1199,1706,815,1040,357)
   (179,828,1258,2031,303,1135)(180,1698,1127,1769,1689,1314)
   (181,639,897,1421,545,1782)(182,525,1151,1630,1019,520)
   (184,907,632,1755,1967,435)(188,1553,1136,1591,1980,948)
   (190,1527,1226,1904,635,1803)(192,230,1131,956,1873,610)
   (193,1157,1762,992,1813,1777)(195,691,1324,1975,1418,319)(196,721)
   (197,1982,1905,658,289,705)(198,1323,1387,923,1011,1456)
   (201,628,1601,1864,1368,401)(202,327,1004,1098,944,2025)
   (203,744,768,1861,852,1240)(204,1060,1575,1341,207,961)
   (205,1922,1718,773,954,329)(209,1531,1052,1785,598,311)
   (210,908,1928,2050,1485,1184)(211,1648,1213,1224,1536,1593)
   (212,665,1570,849,1382,1586)(213,647,379,557,464,1984)
   (214,1342,850,1216,1331,324)(216,2027,467,252,836,1116)
   (217,238,1484,1764,1212,1509)(220,1794,1872,1230,775,1571)
   (222,888,885,1596,1384,814)(223,1927,451,1227,368,1697)
   (228,586,1841,792,717,479)(229,1081,947,1137,602,556)
   (231,1776,1636,1580,840,1657)(232,249,807,1148,1584,2023)
   (233,1829,926,1991,745,1030)(235,1440,1812,1125,1709,1007)
   (237,1644,1274,1464,1635,1787)(240,1035,1439,1002,548,1130)
   (242,1262,927,1494,243,848)(245,1293)(248,1000,413,1233,326,1503)
   (253,1631,500,1182,905,400)(255,667,2057,1162,430,1868)
   (257,1737,1470,1970,1094,1665)(259,549,788,523,1250,1358)
   (260,2021,1533,472,384,1821)(262,1091,1940,388,1719,1852)
   (265,1096,1379,1064,1784,558)(266,310,749,417,1947,1068)
   (268,889,1696,1330,315,2046)(269,800,587,1866,1093,1514)
   (270,625,272,723,640,811)(271,1307,493,630,1491,530)
   (273,1747,1507,881,1971,299)(275,896,1901,2047,454,950)
   (276,436,356,294,608,1467)(278,1659,746,448,626,912)
   (282,1549,1941,1600,424,1290)(284,1645,769,1360,2034,1259)
   (285,1225,1915,295,1276,1730)(286,816,615,312,498,1319)
   (288,1245,593,1741,1346,1746)(293,1198,1369,1174,1616,733)(298,2009)
   (300,325,1465,2010,761,301)(305,1743,414,1955,1551,1537)
   (307,1789,1617,726,1386,1129)(308,1684,1823,656,477,1524)
   (313,698,1207,2037,1486,1474)(316,1053,2022,1989,1639,866)
   (317,359,613,782,1296,1634)(318,1773,504,595,913,535)
   (321,1181,573,1513,410,387)(322,616,1100,1489,713,1499)
   (328,1995,1725,677,1573,338)(330,1816,392,1810,1857,588)
   (331,711,2011,461,1999,1255)(333,915,1054,1961,1623,405)
   (334,564,783,1033,1278,1691)(335,1532,1791,1497,1640,1473)
   (344,1820,1859,855,429,1217)(347,823,1508,1505,442,1186)
   (348,1592,1451,1792,358,1192)(352,1604,1355,1559,1046,1831)
   (355,734,962,1113,1879,507)(362,795,1844,1628,1149,1671)
   (363,1839,1976,878,673,1611)(364,1222,1637,972,601,1742)
   (366,1726,1327,1433,1029,541)(369,631,509,2038,440,1498)
   (373,663,565,799,1919,2028)(374,439,1286,1459,1567,1056)
   (380,521,585,1372,810,738)(381,1748,1566,703,1085,514)
   (383,1282,930,1916,877,1695)(385,1658,1298,902,1074,943)
   (386,2015,1805,786,1983,955)(389,1583,579,1934,1876,2030)
   (393,1407,1179,1712,900,1815)(395,701,1203,1826,696,975)
   (396,1502,868,1147,1059,1254)(398,1802,864,1185,1409,675)
   (399,1088,1377,1899,484,1739)(404,1305,739,489,1801,1902)
   (406,1786,1913,1529,1564,501)(407,1416,1270,1656,2052,1842)
   (408,1385,2032,1159,2016,1260)(412,1057)(415,1911,942,1837,1721,581)
   (416,1863,1722,901,835,1711)(418,1534,524,465,958,797)
   (423,1907,1977,1685,1599,1126)(425,1833,1172,700,1632,1945)
   (431,1016,1347,1758,1612,1965)(432,906,1160,542,474,1561)
   (438,527,1490,1931,543,762)(441,612,781,2041,1303,1297)
   (443,1530,476,1958,2026,1522)(445,1772,1076,1343,568,1847)(447,1442)
   (453,1972,1962,1694,1543,884)(456,462,1267,1350,1891,1105)
   (457,1257,1808,1715,759,1825)(458,917,1458,1646,735,847)
   (460,1834,1504,1209,1288,929)(463,1380,1664,1610,1280,945)
   (470,511,882,1065,916,1952)(471,1985,1283,1595,804,1364)(473,1760)(478,1345)
   (480,2045,1471,1986,1574,1268)(481,2056,1248,1539,519,1322)
   (482,2017,1281,1472,580,891)(483,1949,1390,1411,1720,1302)(486,1026)
   (491,641,982,1935,666,2018)(492,1434,1102,1242,1145,1150)
   (494,550,1594,590,1191,618)(495,1357,1205,934,2024,1337)
   (502,1425,940,518,1897,720)(506,1138,1478,2051,567,1398)
   (508,1208,894,1957,597,1437)(512,899,1678,1318,1926,1870)
   (513,1168,1329,599,1264,1953)(516,1077,627,1609,1388,963)
   (517,1681,1819,1153,2014,756)(522,1031,1111,706,1845,968)
   (526,1025,1034,1188,827,1055)(536,1862,1793,1063,867,2008)
   (537,946,1155,1775,589,829)(547,1328,1271,1251,817,1655)
   (551,1356,712,694,1974,1988)(552,1732,819,1008,2055,1373)
   (553,1817,1441,1708,1633,1214)(560,1089,1767,1158,755,1163)
   (562,1475,600,653,1890,939)(566,1669,1410,1164,932,1641)
   (569,880,1180,1900,854,1079)(571,1404,1765,925,952,1117)
   (576,1049,1178,751,1936,1376)(582,1688,1249,1444,1768,1578)
   (583,1677,1690,1757,1108,2001)(606,1190,1547,1516,2033,1744)
   (609,638,998,1687,1799,2002)(614,1496)(617,1754,689,1436,1099,1647)
   (623,1939,1898,1027,1013,1555)(634,1061,693,1751,750,1607)
   (648,1445,1966,1740,883,1699)(649,1896)(652,1032,1087,1397,1589,1830)
   (655,1707,1673,1171,1432,843)(657,1070,1693,856,681,736)(662,1313)
   (664,967,777,976,1625,921)(672,1435,1463,1752,1419,1851)
   (679,1453,682,687,1165,1576)(684,1239,1461,951,1717,1959)
   (697,1232,1370,1987,1223,731)(707,1454,965,862,1406,1937)
   (708,832,1082,1175,1541,1238)(709,1560,1306,1993,1814,771)
   (716,1889,1501,1071,1783,971)(719,1981,1756,1294,974,834)
   (722,1963,1134,1202,1045,1092)(732,983,1827,784,1638,978)
   (741,1455,1041,1582,959,1909)(765,801,1795,857,876,1243)
   (779,938,1797,1247,1412,1680)(787,1525,1667,1838,922,1438)
   (789,1858,1770,949,1123,1930)(790,1661,1619,1938,1572,928)
   (796,911,2049,994,1334,986)(805,1893,1050,1622,1353,1702)
   (818,1788,838,977,1869,1336)(858,1705,1291,1618,1300,1316)
   (860,1244,1466,1519,1700,865)(870,1132,1206,1231,1237,1903)
   (873,1161,1557,1408,1950,1500)(890,1597,1875,1649,1003,1728)(892,1378)
   (903,1716,1587,2020,1114,1265)(904,1106,1629,1399,1548,1771)
   (964,1183,1683,1908,1042,1822)(966,1880,1790,1218,1462,1811)
   (969,1605,2019,1109,1058,1520)(989,1853,1682,1104,1295,1882)(990,1832)
   (991,1710,1272,1569,1124,1714)(1010,1446,1020,1156,1515,1480)
   (1037,1221,1565,1668,1351,1729)(1039,1143,1506,1738,1448,1590)
   (1086,2044,1375,1735,1914,1393)(1144,1431,1315,1495,1197,1585)(1152,1733)
   (1194,1990,1269,1920,1855,1236)(1201,1304)(1228,1883,1750,1652,1736,1968)
   (1273,1417,1528,1954,1865,1906)(1402,1840)(1550,1997) #CAST 
   SymmetricGroup(2058)
    ;
  he2:=SubStructure(SymmetricGroup(2058),c,#TODO CLOSURE
    d);
  a:=(c*d*c*d*c*d*d*c*d*c*d*d*c*d)^14;
  b:=(c*d*d)^-2*(c*d*c*d*c*d*d)^3*(c*d*d)^2;
  he:=SubStructure(he2,a,#TODO CLOSURE
    b);
  he2:=SubStructure(he2,a,#TODO CLOSURE
    b,d);
  if Print > 1 then
    Print("Calling FPGroupStrong");
  fi;
  # =v= MULTIASSIGN =v=
  phi:=FPGroupStrong(he);
  F:=phi.val1;
  phi:=phi.val2;
  # =^= MULTIASSIGN =^=
  if Print > 1 then
    Print("Setting up isomorphism");
  fi;
  soc:=Socle(group);
  #   Find any element of order 10 or 28. This then powers to a 2A-element ag
  repeat
    ag:=Random(soc);
    
  until Order(ag)=10 or Order(ag)=28;
  ag:=ag^(QuoInt(Order(ag),2));
  #   Find any element of order 8. Its fourth power is a 2B-element zg, say.
  repeat
    zg:=Random(soc);
    
  until Order(zg)=8;
  zg:=zg^4;
  #   Find two conjugates of zg, whose product has order 7 or 21.
  #   This powers to a 7C-element bg, say.
  repeat
    zgc:=zg^Random(soc);
    
  until Order(zg*zgc)=7 or Order(zg*zgc)=21;
  bg:=(zg*zgc)^(QuoInt(Order(zg*zgc),7));
  #  Find a conjugate of ag and a conjugate of y, whose product has order 17.
  repeat
    bg:=bg^Random(soc);
    
  until Order(ag*bg)=17;
  soc:=SubStructure(soc,ag,#TODO CLOSURE
    bg);
  homom:=GroupHomomorphismByImages(soc,he,
    GeneratorsOfGroup(soc),[a,b]);
  #  change generators of group to get those of soc coming first
  newgens:=[ag,bg];
  for g in Generators(group) do
    if not g in SubStructure(group,newgens) then
      Add(newgens,g);
    fi;
  od;
  group:=SubStructure(group,newgens);
  aut:=Index(group,soc)=2;
  #  Now identify images of all generators of group in he2.
  ims:=[a,b];
  for i in [Ngens(soc)+1..Ngens(group)] do
    g:=group.i;
    CG:=he2;
    ce:=One(he2);
    for j in [1..Ngens(he)] do
      # =v= MULTIASSIGN =v=
      h:=IsConjugate(CG,(he.j)^ce,((soc.j)^g)@homom);
      isc:=h.val1;
      h:=h.val2;
      # =^= MULTIASSIGN =^=
      if not isc then
        Error("Conjugation error in Aut(He)");
      fi;
      CG:=Centraliser(CG,((soc.j)^g)@homom);
      ce:=ce*h;
    od;
    Add(ims,ce);
  od;
  #  and extend homomorphism from group -> he2
  homom:=GroupHomomorphismByImages(group,he2,
    GeneratorsOfGroup(group),ims);
  maximals:=[];
  if not max then
    return rec(val1:=homom,
      val2:=he2,
      val3:=maximals,
      val4:=F,
      val5:=phi);
  fi;
  if Print > 1 then
    Print("Getting maximals");
  fi;
  Add(maximals,Stabiliser(he,1));
  #  S_4(4):2
  if aut then
    Add(maximals,Stabiliser(he,[1,1571]));
  fi;
  #  (S5xS5):2
  Add(maximals,Stabiliser(he,Set([102,279,310,312,333,334,385,564,747,783,1181,
   1205,1284,1434,1488,1499,1504,1557,1655,1729,1876])));
  #  2^2.L_3(4).D_12
  S:=Stabiliser(he,Set([747,783,913,1003,1629,2011]));
  if not aut then
    Add(maximals,S);
    #  2^6:3.A6
    Add(maximals,S^d);
    #  2^6:3.A6
  else
    #  novelty
    Add(maximals,Stabiliser(he,Set([1,2])));
    #  2^(4+4).(S3xS3).2
  fi;
  S2:=Sylow(he,2);
  Add(maximals,Centraliser(he,Centre(S2)));
  #  2^(1+6).L_3(2).2
  S7:=Sylow(he,7);
  ZS7:=Centre(S7);
  NE7:=Normaliser(he,SubStructure(S7,ZS7.1,#TODO CLOSURE
    Random(S7)));
  while Size(NE7)<>16464 do
    NE7:=Normaliser(he,SubStructure(S7,ZS7.1,#TODO CLOSURE
      Random(S7)));
  od;
  Add(maximals,NE7);
  #  7^2:2.L_2(7).
  S3:=Sylow(he,3);
  Add(maximals,Normaliser(he,Centre(S3)));
  #  3.S7
  Add(maximals,Normaliser(he,S7));
  #  7^{1+2}:(S3x3)
  Add(maximals,Stabiliser(he,Set([102,143,225,304,312,333,406,647,657,728,747,
   783,998,1104,1111,1181,1205,1224,1435,1724,2035])));
  #  S4xL_2(7)
  N7:=Normaliser(he,SubStructure(he,Random(S7)));
  while Size(N7)<>3528 do
    N7:=Normaliser(he,SubStructure(he,Random(S7)));
  od;
  Add(maximals,N7);
  #  7:3 x L_2(7).
  Add(maximals,Normaliser(he,Sylow(he,5)));
  #  5^2:4A4
  return rec(val1:=homom,
    val2:=he2,
    val3:=maximals,
    val4:=F,
    val5:=phi);
end);



#  File converted from Magma code -- requires editing and checking
#  Magma -> GAP converter, version 0.43, 4/04/16 by AH

#  Global Variables used: Append, BasicStabilizer, Centraliser, Generators, Id,
#  Index, IsConjugate, Ngens, Order, Random, RandomProcess, Socle, Sym,
#  get_standard_gens_tits, homom

#  Defines: TitsIdentify, get_standard_gens_tits

DeclareGlobalFunction("TitsIdentify@");

get_standard_gens_tits@:=function(G)
local P,a,b,ord;
  P:=RandomProcess(G);
  repeat
    a:=Random(P);
    ord:=Order(a);
    
  until ord in Set([10,16]);
  a:=a^(QuoInt(ord,2));
  repeat
    b:=Random(P);
    ord:=Order(b);
    
  until ord mod 3=0;
  b:=b^(QuoInt(ord,3));
  repeat
    b:=b^Random(P);
    
  until Order(a*b)=13;
  return rec(val1:=a,
    val2:=b);
end;
;
InstallGlobalFunction(TitsIdentify@,
function(group)
local 
   CG,F,M,Print,S,a,atits,aut,b,c,ce,g,ga,gb,group,h,homom,i,ims,isc,j,max,
   maximals,newgens,phi,simp,soc;
  max:=ValueOption("max");
  if max=fail then
    max:=true;
  fi;
  Print:=ValueOption("Print");
  if Print=fail then
    Print:=0;
  fi;
  S:=SymmetricGroup(1755);
  a:=(1,585)(2,1485)(3,618)(4,1525)(5,1116)(6,383)(7,1404)(8,507)(9,329)
   (10,1657)(11,378)(12,379)(13,1716)(14,821)(15,1522)(16,336)(17,1160)(18,1625)
   (19,1673)(20,946)(21,1030)(22,1213)(23,1550)(24,1013)(25,314)(26,1229)
   (27,1555)(28,1652)(29,1616)(30,171)(31,1122)(32,1631)(33,89)(34,1028)
   (35,1705)(36,1577)(37,500)(38,424)(39,812)(40,429)(41,1057)(42,749)(43,813)
   (44,1367)(45,615)(46,1179)(47,1373)(48,1501)(49,1682)(50,793)(51,915)
   (52,1078)(53,409)(54,56)(55,1649)(57,667)(58,1384)(59,1101)(60,937)(61,443)
   (62,771)(63,652)(64,1607)(65,607)(66,137)(67,1520)(68,1137)(69,418)(70,600)
   (71,523)(72,1561)(73,419)(74,757)(75,753)(76,845)(77,993)(78,1718)(79,1572)
   (80,1532)(81,192)(82,441)(84,1287)(85,333)(86,286)(87,1131)(88,1732)(90,312)
   (91,1540)(92,669)(93,1253)(94,926)(95,535)(96,399)(97,1473)(98,300)(99,959)
   (100,488)(101,1435)(102,1317)(103,1147)(104,1085)(105,1465)(106,159)(107,742)
   (108,1690)(110,221)(111,582)(112,1423)(113,1016)(114,455)(115,849)(116,324)
   (117,883)(119,529)(120,1365)(121,1459)(122,1049)(123,195)(125,1752)(126,1314)
   (128,1051)(129,760)(132,568)(133,547)(134,1294)(135,1667)(136,252)(138,1703)
   (139,1672)(140,1397)(141,1063)(142,610)(143,1340)(144,1727)(145,704)
   (146,1369)(147,1472)(148,533)(149,1212)(150,1611)(151,1185)(152,984)
   (153,1190)(154,972)(155,1564)(156,1216)(157,1251)(158,1466)(160,626)(161,633)
   (163,727)(164,1275)(165,1387)(166,579)(167,1588)(168,401)(169,1245)(170,389)
   (173,1221)(174,1319)(176,1337)(177,1590)(179,721)(180,1055)(181,326)
   (182,1115)(183,593)(184,1047)(185,673)(186,1238)(187,303)(188,190)(191,1265)
   (193,878)(196,945)(197,1683)(198,660)(199,893)(200,1526)(201,1661)(202,832)
   (203,930)(204,1082)(205,1270)(206,980)(207,1027)(208,1105)(209,1444)
   (210,1447)(211,428)(212,792)(213,1585)(214,982)(215,405)(216,1129)(217,1018)
   (218,1372)(219,1617)(220,1461)(223,722)(224,1592)(225,1171)(226,1557)
   (227,995)(228,245)(229,1195)(230,1755)(232,728)(233,1594)(234,1724)(235,1414)
   (236,1297)(237,1478)(238,1463)(239,801)(240,1234)(241,903)(242,658)(243,599)
   (244,1597)(246,952)(247,253)(248,790)(249,359)(250,1524)(251,509)(254,366)
   (255,461)(256,407)(257,1482)(258,351)(259,518)(260,1088)(262,1481)(263,897)
   (264,1000)(265,472)(266,1556)(267,1233)(268,1307)(269,1120)(270,548)(271,528)
   (272,1456)(273,513)(274,1014)(275,546)(276,1711)(277,1589)(278,555)(280,316)
   (281,770)(282,735)(283,638)(284,589)(285,1380)(287,1046)(289,1664)(290,559)
   (291,1688)(292,1598)(293,467)(294,1102)(295,1348)(296,1151)(297,478)
   (298,1113)(299,750)(301,1390)(302,1181)(304,306)(305,881)(308,1145)(309,319)
   (310,400)(311,493)(313,764)(315,948)(318,1722)(320,1422)(321,1674)(322,769)
   (323,1249)(325,949)(327,910)(328,1065)(330,395)(331,1339)(332,842)(334,1330)
   (335,1132)(337,896)(338,1606)(339,1303)(340,1698)(341,1225)(342,382)
   (343,1315)(344,1476)(345,1313)(346,1609)(347,933)(348,1056)(349,1434)
   (350,636)(352,521)(353,822)(354,1665)(355,1586)(356,1494)(358,522)(360,1158)
   (361,1342)(362,785)(363,892)(364,634)(365,1242)(367,1134)(368,1002)(369,1094)
   (370,563)(371,791)(372,1378)(373,730)(374,456)(375,1096)(376,1177)(380,1327)
   (381,1008)(384,692)(385,1500)(388,1173)(390,545)(391,1453)(392,795)(393,482)
   (394,1248)(396,1536)(397,1641)(398,1571)(402,1240)(403,856)(404,999)
   (406,1089)(408,1148)(410,1479)(411,1188)(412,659)(413,941)(414,1620)
   (415,1593)(416,784)(417,758)(420,1346)(421,761)(422,1244)(423,1565)(425,1228)
   (427,590)(431,936)(432,558)(433,537)(434,741)(435,1735)(436,1135)(437,830)
   (438,1601)(439,1320)(440,1477)(442,968)(444,1393)(445,1452)(446,668)
   (447,1736)(448,1634)(449,1528)(450,1146)(452,917)(453,1420)(454,1360)
   (457,1019)(458,1457)(459,1239)(460,1112)(462,525)(463,1231)(464,1296)
   (465,1636)(466,1622)(468,1595)(469,1059)(470,696)(471,1512)(473,1547)
   (474,1168)(475,1075)(476,876)(477,1741)(479,1250)(480,1273)(483,831)(484,573)
   (485,1219)(486,1068)(487,1175)(490,1412)(491,1619)(492,720)(494,1499)
   (495,891)(496,1226)(497,1103)(498,1513)(499,1596)(501,1121)(502,1562)
   (503,1034)(504,953)(505,614)(506,1192)(510,512)(511,581)(514,820)(515,601)
   (516,782)(517,1183)(519,1361)(520,674)(524,606)(526,863)(527,712)(534,679)
   (536,1281)(538,1169)(539,703)(540,635)(541,605)(542,1277)(543,1252)(544,1292)
   (550,806)(551,835)(552,1389)(554,657)(556,1692)(557,1416)(560,1386)(561,997)
   (562,654)(565,1379)(566,1618)(567,686)(569,725)(570,650)(571,1217)(572,611)
   (574,1433)(575,1079)(577,1045)(578,1106)(580,1720)(583,665)(584,1728)
   (586,1744)(587,1427)(588,644)(591,1108)(592,969)(594,829)(595,752)(596,1286)
   (597,1610)(598,1080)(602,1166)(603,1167)(604,1165)(608,1612)(609,922)
   (612,916)(613,1591)(616,1170)(617,1187)(619,1336)(620,1738)(621,1285)
   (622,1475)(623,1163)(624,642)(625,683)(627,938)(628,918)(629,1029)(630,1534)
   (632,1130)(637,796)(639,1492)(640,1302)(641,1660)(643,1214)(645,861)
   (646,1399)(647,1176)(648,1632)(649,1411)(651,1469)(653,1262)(655,1236)
   (656,1702)(661,970)(662,1679)(663,1624)(664,685)(666,1685)(670,731)(671,1708)
   (672,1329)(675,1467)(676,1205)(677,1356)(680,1097)(681,1050)(682,888)
   (684,765)(687,1193)(689,1470)(690,865)(691,1159)(693,1070)(694,988)(695,1642)
   (697,1215)(698,710)(699,895)(700,1742)(701,1699)(702,1385)(705,1671)(706,724)
   (707,973)(708,1663)(709,1643)(711,1691)(713,1490)(715,1098)(716,1733)
   (717,747)(718,1109)(719,1368)(723,1178)(732,886)(733,1260)(734,1200)
   (736,1676)(737,1498)(738,1316)(739,1739)(740,1062)(743,992)(745,1052)
   (746,779)(748,955)(751,907)(754,1605)(755,1638)(756,979)(762,1483)(763,944)
   (766,776)(767,1354)(768,809)(773,1516)(774,1443)(775,871)(777,1274)(778,1715)
   (780,1211)(781,1271)(783,1157)(786,1352)(787,1391)(788,1471)(789,1578)
   (794,1359)(797,1439)(798,1441)(799,1255)(800,1566)(802,827)(803,814)
   (804,1140)(805,1635)(807,956)(810,923)(811,1751)(815,1721)(818,1604)
   (819,1464)(823,943)(824,1574)(825,1280)(826,1306)(828,855)(833,1351)
   (834,1283)(836,1570)(837,974)(838,882)(839,1637)(840,1093)(841,1552)
   (843,1334)(844,1127)(846,862)(847,1388)(848,1486)(850,1543)(851,1025)
   (852,1154)(853,857)(854,1338)(858,1005)(859,1246)(860,1398)(864,1514)
   (866,1406)(867,1263)(868,1139)(869,889)(870,1553)(872,947)(873,877)(874,1410)
   (875,1530)(879,1437)(880,1644)(884,1258)(885,1537)(887,1396)(890,1695)
   (898,989)(899,1366)(900,1713)(901,1497)(902,1527)(904,940)(905,1218)
   (906,1136)(908,1199)(909,1323)(911,1430)(912,1033)(914,1322)(919,1100)
   (920,1001)(921,1086)(924,1509)(925,954)(927,1184)(928,1026)(929,1060)
   (931,1254)(932,1224)(934,1541)(935,1081)(939,1484)(942,1003)(950,1407)
   (951,1349)(957,1149)(960,1182)(961,1569)(962,1095)(963,1174)(964,1409)
   (966,1053)(967,1073)(971,1259)(975,1395)(976,1544)(977,1495)(978,1331)
   (981,1237)(985,1750)(986,998)(987,1204)(990,1613)(991,1675)(994,1076)
   (996,1701)(1004,1731)(1006,1418)(1007,1196)(1010,1602)(1011,1266)(1012,1640)
   (1015,1506)(1017,1600)(1020,1333)(1023,1036)(1024,1694)(1031,1621)(1032,1579)
   (1035,1267)(1038,1648)(1039,1141)(1041,1496)(1042,1223)(1043,1299)(1044,1603)
   (1048,1535)(1054,1293)(1058,1206)(1064,1653)(1066,1152)(1067,1374)(1069,1503)
   (1071,1710)(1072,1269)(1074,1268)(1077,1364)(1083,1754)(1084,1686)(1087,1748)
   (1090,1421)(1091,1301)(1092,1180)(1099,1670)(1107,1567)(1110,1669)(1114,1531)
   (1117,1650)(1118,1646)(1123,1746)(1124,1474)(1125,1417)(1126,1424)(1128,1749)
   (1133,1438)(1138,1480)(1142,1655)(1143,1659)(1144,1454)(1150,1558)(1153,1488)
   (1155,1261)(1161,1400)(1162,1189)(1164,1345)(1172,1549)(1186,1413)(1191,1282)
   (1194,1627)(1197,1355)(1198,1554)(1201,1207)(1202,1343)(1203,1581)(1208,1403)
   (1209,1318)(1210,1489)(1220,1651)(1222,1357)(1227,1401)(1230,1450)(1235,1353)
   (1241,1709)(1243,1295)(1247,1311)(1256,1505)(1257,1654)(1264,1392)(1272,1723)
   (1276,1468)(1278,1647)(1279,1523)(1284,1630)(1290,1700)(1298,1394)(1300,1408)
   (1304,1377)(1308,1626)(1309,1370)(1310,1681)(1312,1402)(1321,1426)(1324,1440)
   (1325,1446)(1328,1347)(1332,1376)(1335,1712)(1341,1521)(1344,1358)(1350,1502)
   (1362,1559)(1363,1415)(1371,1740)(1381,1747)(1382,1510)(1405,1429)(1419,1533)
   (1428,1726)(1431,1677)(1432,1734)(1442,1587)(1445,1487)(1448,1455)(1449,1662)
   (1458,1729)(1462,1717)(1491,1633)(1504,1680)(1507,1628)(1508,1707)(1511,1697)
   (1515,1583)(1517,1529)(1518,1568)(1519,1693)(1538,1719)(1539,1745)(1548,1725)
   (1551,1696)(1560,1584)(1563,1573)(1576,1629)(1580,1614)(1582,1599)(1615,1639)
   (1645,1678)(1656,1658)(1687,1714)(1689,1730) #CAST S
    ;
  b:=(1,20,287)(2,13,836)(3,1218,799)(4,1458,241)(5,454,226)(6,1663,1041)
   (7,402,1224)(8,384,794)(9,102,505)(10,489,1310)(11,220,1741)(12,132,1227)
   (14,986,1646)(15,1077,847)(16,323,292)(17,578,662)(18,344,858)(19,736,1256)
   (21,1142,1158)(22,1615,1067)(23,382,1412)(24,1085,170)(25,356,418)
   (26,1668,230)(27,81,1734)(28,1416,333)(29,702,1731)(30,1638,570)
   (31,1581,1450)(32,902,1726)(33,1712,41)(34,193,95)(35,1461,842)(36,1203,1690)
   (37,390,1202)(38,1380,140)(39,227,60)(40,673,893)(42,1231,577)(43,443,771)
   (44,816,1593)(45,751,377)(46,630,1290)(47,862,919)(48,511,982)(49,1430,1073)
   (50,696,685)(51,1147,911)(52,381,1352)(53,142,1148)(54,68,660)(55,171,914)
   (56,149,353)(57,283,1387)(58,1630,954)(59,1568,1110)(61,1653,1507)
   (62,1133,684)(63,399,1589)(64,889,165)(65,1171,386)(66,424,1695)(67,619,1694)
   (69,1407,567)(70,97,1333)(71,1378,1592)(72,712,756)(73,762,275)(74,1060,512)
   (75,885,831)(76,288,406)(77,1379,611)(78,314,1488)(79,1388,1192)(80,346,929)
   (82,705,770)(83,1286,1018)(84,1270,1715)(85,1365,535)(86,1686,1154)
   (87,388,606)(88,741,1515)(89,1195,378)(90,731,124)(91,576,760)(92,672,974)
   (93,1599,588)(94,654,1295)(96,1735,1745)(98,663,361)(99,994,631)
   (100,1013,1043)(101,1669,391)(103,1621,1475)(104,152,1297)(105,1144,1675)
   (106,1457,952)(107,211,1641)(108,1179,1497)(109,1268,772)(110,429,1401)
   (111,1527,1558)(112,834,933)(113,187,608)(114,1451,1056)(115,1396,1489)
   (116,790,823)(117,520,479)(118,1338,1283)(119,1183,470)(120,1459,564)
   (121,648,150)(122,675,342)(123,313,1349)(125,1190,1247)(126,1015,276)
   (127,259,540)(128,1448,851)(129,447,228)(130,471,1358)(131,953,458)
   (133,963,909)(134,1454,1271)(135,677,1650)(136,207,1424)(137,1008,1021)
   (138,1559,1066)(139,1676,289)(141,1281,1406)(143,604,252)(144,1728,1052)
   (145,277,536)(146,814,534)(147,1479,1136)(148,154,1222)(151,1390,195)
   (153,651,500)(155,1111,598)(156,325,400)(157,450,1312)(158,1447,425)
   (159,380,1551)(160,1187,612)(161,490,208)(162,1185,233)(163,1368,416)
   (164,1534,989)(166,526,1016)(167,168,957)(169,1520,746)(172,683,358)
   (173,1320,359)(174,407,268)(175,961,948)(176,583,1465)(177,488,1036)
   (178,940,767)(179,1470,397)(180,1196,1311)(181,977,463)(182,931,254)
   (183,1128,1645)(184,951,1300)(185,899,1273)(186,1138,1502)(188,467,594)
   (189,1105,1750)(190,514,793)(191,857,587)(192,550,1322)(194,983,827)
   (196,1099,1425)(197,1720,485)(198,1260,460)(199,610,867)(200,1092,1301)
   (201,1649,1487)(202,693,1503)(203,1172,649)(204,634,1035)(205,515,1266)
   (206,1635,303)(209,928,449)(210,1394,850)(212,434,1519)(213,435,1468)
   (214,1626,707)(215,1193,1278)(216,430,1746)(217,1181,1617)(218,1576,1074)
   (219,1598,1326)(221,1068,908)(222,1219,1058)(223,1420,670)(224,265,308)
   (225,1471,1097)(229,299,1208)(231,1724,1176)(232,1521,803)(234,676,910)
   (235,1233,1442)(236,1614,785)(237,1094,320)(238,600,747)(239,713,1625)
   (240,692,242)(243,364,376)(244,913,798)(245,1526,599)(246,1529,738)
   (247,1245,1238)(248,1718,1710)(249,1570,807)(250,1048,980)(251,1455,519)
   (253,297,421)(255,786,1194)(256,830,1341)(257,293,990)(258,1733,1275)
   (260,1257,566)(261,843,1088)(262,1711,1473)(263,1506,873)(264,1170,1436)
   (266,1426,872)(267,1419,409)(269,704,338)(270,1595,765)(271,1509,874)
   (272,1409,1476)(273,1664,1648)(274,907,1336)(278,1384,1701)(279,280,1303)
   (281,1463,714)(282,1243,499)(284,680,1109)(285,691,350)(286,1131,1397)
   (290,309,1605)(291,444,1197)(294,1516,312)(295,546,408)(296,1725,1688)
   (298,457,1700)(300,768,1098)(301,1220,1000)(302,1167,327)(304,348,345)
   (305,846,473)(306,715,1651)(307,972,1355)(310,474,1075)(311,758,1037)
   (315,1116,1140)(316,1737,1739)(317,629,959)(318,1342,668)(319,1236,1239)
   (321,1178,1644)(322,451,558)(324,1152,1166)(326,745,1569)(328,1031,339)
   (329,491,1382)(330,848,1221)(331,1323,1107)(332,1381,937)(334,544,978)
   (335,1580,1704)(336,618,1485)(337,666,1404)(340,938,1613)(341,1666,1205)
   (343,624,1563)(347,734,565)(349,778,1500)(351,877,393)(352,419,1006)
   (354,1248,894)(355,1288,779)(357,686,674)(360,1553,1086)(362,1127,1654)
   (363,653,1699)(365,644,1402)(366,1027,861)(367,1265,1590)(368,1184,1662)
   (369,1714,1262)(370,413,829)(371,420,941)(372,1740,1531)(373,1143,414)
   (374,792,708)(375,1251,569)(379,1418,466)(383,1366,1001)(385,1751,695)
   (387,1002,1490)(389,521,455)(392,946,808)(394,554,627)(395,440,727)
   (396,1574,1491)(398,985,1727)(401,979,813)(403,789,1345)(404,764,1612)
   (405,815,586)(410,710,1139)(411,1215,1269)(412,591,1026)(415,1159,1112)
   (417,1386,441)(422,1415,452)(423,1252,1019)(426,718,508)(427,1217,1642)
   (428,1344,1054)(431,1518,1679)(432,1033,1567)(433,1009,553)(436,833,775)
   (437,1082,733)(438,1325,626)(439,1334,973)(442,1173,981)(445,1329,584)
   (446,559,1697)(448,1028,1305)(453,1212,1528)(456,1201,757)(459,1477,1276)
   (461,1441,1321)(462,1237,659)(464,1063,969)(465,560,1732)(468,890,589)
   (469,855,787)(472,1244,1505)(475,1294,1594)(476,1717,656)(477,1445,967)
   (478,1702,1672)(480,1264,1200)(481,527,809)(482,1410,898)(483,1047,1611)
   (484,1677,1656)(486,1561,1046)(487,1250,1671)(492,1748,1539)(493,826,645)
   (494,876,1524)(495,547,1061)(496,763,1123)(497,1504,805)(498,1132,866)
   (501,1548,945)(502,1627,1055)(503,819,1736)(504,1376,1168)(506,1435,852)
   (507,1398,1204)(509,1495,1229)(510,1428,1517)(513,628,1242)(516,1124,556)
   (517,1369,1492)(518,1042,828)(522,1578,1514)(523,766,1337)(524,1421,993)
   (525,920,726)(528,530,1413)(529,1530,917)(531,1544,1596)(532,1308,1399)
   (533,924,669)(537,1096,1020)(538,1708,1753)(539,1044,1647)(541,1163,1474)
   (542,879,1330)(543,601,1285)(545,632,860)(548,1693,1523)(549,613,1313)
   (551,1155,1335)(552,777,1210)(555,1678,753)(557,1667,650)(561,1354,1549)
   (562,1069,1051)(563,1472,832)(568,806,1261)(571,1547,853)(572,607,1684)
   (573,1640,1186)(574,1374,1584)(575,840,1682)(579,1145,1723)(580,620,1324)
   (581,944,1174)(582,1729,918)(585,1030,1414)(590,1022,1560)(592,1600,1089)
   (593,1164,1533)(595,1637,1713)(596,1587,699)(597,679,1070)(602,1721,1083)
   (603,723,641)(605,725,1512)(609,1331,1423)(614,1150,1481)(615,1306,1316)
   (616,835,776)(617,694,965)(621,1670,1213)(622,665,958)(623,1683,700)
   (625,1370,1175)(633,1660,1232)(635,1652,750)(636,988,1550)(637,1532,1439)
   (638,1665,964)(639,837,901)(640,1431,1752)(642,1225,1053)(643,1081,681)
   (646,1501,864)(647,1391,732)(652,1719,1141)(655,1296,1117)(657,1462,682)
   (658,1367,1525)(661,1392,1039)(664,1433,1209)(667,1214,1272)(671,1601,689)
   (678,1057,956)(687,783,947)(688,711,1571)(690,1616,1632)(697,1707,1038)
   (698,1629,1293)(701,1119,971)(703,1456,791)(706,1538,1095)(709,1606,1228)
   (716,1411,1115)(717,1258,1327)(719,1188,1226)(720,1318,863)(721,1087,810)
   (722,896,1340)(724,999,1289)(728,1566,897)(729,1618,1309)(730,1101,868)
   (735,1754,1449)(737,880,1422)(739,1274,991)(740,1585,1555)(742,839,1573)
   (743,1216,884)(744,1620,1125)(748,1705,905)(749,915,1673)(752,1657,1106)
   (754,1496,1634)(755,804,1114)(759,871,1182)(761,1602,1153)(769,960,1108)
   (773,1050,932)(774,1744,838)(780,1363,1742)(781,1120,1299)(782,1464,1689)
   (784,1091,1546)(788,1543,1149)(795,1249,856)(796,1126,1064)(797,1687,1347)
   (800,997,1146)(801,1162,1240)(802,1738,966)(811,1400,1499)(812,1102,1480)
   (817,859,841)(818,1685,1010)(820,1287,1356)(821,1359,1199)(822,1034,921)
   (824,1161,881)(825,1103,1017)(844,1246,1556)(845,1643,939)(849,1045,1586)
   (854,1609,1722)(865,1023,1535)(869,1040,984)(870,1206,1255)(875,1059,1691)
   (878,1130,895)(882,1049,1151)(883,1113,1014)(886,1575,1440)(887,1134,1371)
   (888,1029,1541)(891,1659,1353)(892,1554,1012)(900,1282,1674)(903,904,1211)
   (906,1005,1681)(912,1453,1562)(916,987,1438)(922,992,1284)(923,1747,1180)
   (925,1730,1328)(926,1452,1393)(927,1032,1362)(930,1080,1604)(934,943,1552)
   (935,1104,1427)(936,1698,1429)(942,1137,1383)(949,1298,1583)(950,1076,1619)
   (955,1315,1743)(962,1065,1437)(968,1234,1655)(970,1432,1484)(975,1572,1510)
   (976,1319,1230)(995,1361,1003)(996,1631,998)(1004,1622,1277)(1007,1241,1633)
   (1011,1360,1198)(1024,1508,1434)(1025,1417,1177)(1062,1680,1405)
   (1071,1189,1364)(1072,1291,1135)(1078,1522,1444)(1079,1493,1385)
   (1084,1191,1628)(1090,1706,1588)(1093,1350,1351)(1100,1259,1709)
   (1118,1292,1332)(1121,1346,1603)(1122,1579,1564)(1129,1235,1582)
   (1156,1716,1223)(1157,1658,1565)(1160,1755,1661)(1165,1304,1542)
   (1169,1692,1557)(1207,1395,1536)(1253,1623,1267)(1254,1608,1317)
   (1263,1636,1591)(1279,1377,1373)(1280,1607,1597)(1302,1639,1446)
   (1307,1357,1467)(1314,1478,1469)(1339,1749,1540)(1343,1696,1537)
   (1348,1511,1408)(1372,1482,1513)(1375,1389,1460)(1403,1483,1486)
   (1443,1610,1498)(1466,1624,1545)(1494,1577,1703) #CAST S
    ;
  c:=(6,22,23,109)(7,37,31,175)(8,27,52,127)(9,46,49,69)(10,43,198,199)
   (12,241,176,227)(13,325,583,379)(14,82)(15,80,860,890)(20,81)(21,51)
   (24,97,362,433)(25,128,322,387)(26,466,520,585)(28,47,48,70)(29,250,251,714)
   (30,252,139,726)(32,253,217,650)(33,140)(34,798,112,174)(35,63,144,145)
   (38,62,796,866)(39,256,74,108)(40,326,269,1036)(41,50)(44,647)(45,626)
   (53,278,438,684)(54,1125,712,1071)(55,814,1018,1311)(56,579,578,577)
   (57,296,173,932)(58,59,302,600)(60,390,132,131)(61,260)(64,1177,1490,1501)
   (65,1012,1491,1009)(66,1313,832,1095)(67,1176,1139,68)(71,272,1006,356)
   (72,218,1007,1008)(73,918,663,713)(75,76,77,285)(78,284,354,1022)
   (79,167,166,292)(83,164,986,1066)(84,880,222,1359)(85,793,1172,1088)
   (88,1092,1221,1299)(89,501,673,1602)(90,803,627,633)(91,92,924,537)
   (93,94,485,1374)(95,471,1707,1706)(96,1742,1461,765)(98,258,1093,1116)
   (99,677,1662,965)(100,458,452,183)(101,799,117,102)(103,1019,912,270)
   (104,107,106,105)(110,576,353,541)(111,262,735,736)(113,114,115,522)
   (116,523,716,380)(118,1322,1309,119)(120,1184,1423,640)(121,527,1120,1107)
   (122,389,1002,1542)(123,133,1050,1169)(124,130,531,532)(125,414,837,343)
   (126,963,795,960)(129,1394,1421,1215)(134,288,391,135)(136,1152,1040,1049)
   (138,261,539,465)(141,274,439,1698)(142,1533,151,517)(143,384,373,259)
   (146,147,563,916)(148,149,917,206)(150,820,929,678)(152,1288,689,153)
   (154,1411,886,1502)(155,1545,1329,1555)(156,865,1315,157)(158,785,864,207)
   (159,812,1126,1678)(160,311,791,1318)(161,849,225,1331)(162,722,998,1672)
   (163,460,481,383)(165,979,767,915)(168,372,429,747)(169,172,171,170)
   (177,1741,1631,195)(178,1353,1282,750)(179,1506,1523,1385)(180,608,962,345)
   (181,1710,1711,1146)(182,1212,1596,1477)(184,775,757,763)(187,194,754,208)
   (188,806,807,1085)(190,291,906,321)(191,936,610,1450)(192,858,521,193)
   (196,1744,839,1405)(197,1743,1611,1190)(200,201)(202,203)(204,497,1307,1717)
   (205,1200,1705,1220)(209,1622)(210,1546,1648,211)(212,637,636,1702)(213,635)
   (214,594,634,1183)(215,1091,943,783)(216,1360,1440,584)(219,928,1186,1476)
   (220,385,381,835)(221,1451,1075,1202)(223,1445,1245,530)(224,352)
   (226,939,762,551)(228,234)(230,242)(233,1042,1043,416)(236,237)
   (238,277,289,612)(239,675,1217,1230)(240,506,508,507)(245,1505,540,1339)
   (246,463,462,953)(247,938,375,538)(248,727,1751,816)(249,616,587,995)
   (254,1568,699,255)(257,1223,1224,1670)(263,1255,948,1053)(264,853,1280,1513)
   (265,655,533,957)(266,966,1087,267)(268,641,363,432)(271,746,555,1158)
   (273,764,654,623)(275,1650,1447,549)(276,1178,478,1045)(279,1346,1207,1550)
   (280,1201,436,1704)(281,1090,1464,548)(282,376,445,283)(286,309,1525,512)
   (287,1287,303,1021)(290,1499,440,513)(293,950,350,1427)(294,324,339,340)
   (295,881,1348,1559)(297,369,1023,403)(298,1361,1102,402)(299,553,1565,1244)
   (300,1714,889,840)(301,659,493,1209)(304,305,306,1362)(307,729,1383,1753)
   (308,504,503,1380)(310,662,718,344)(312,388,547,455)(313,1272,1236,1199)
   (314,1524,1633,1684)(315,992,748,1731)(316,830,811,377)(317,790,1213,1135)
   (318,976,885,944)(319,510)(320,524,657,697)(323,887,834,400)
   (327,891,787,1129)(328,1728,1379,382)(329,1408,696,606)(330,1409,1241,871)
   (331,1347,1415,1402)(332,1247,1069,1171)(333,1551,1392,968)(334,464,878,967)
   (335,1472,1730,899)(336,873,1195,1443)(337,1197,1473,1205)(338,707,1595,1594)
   (341,342,495,1446)(346,349,348,347)(351,602)(355,863)(357,1038,725,1700)
   (358,630,1432,1503)(359,1114,664,665)(360,1484,1630,1480)(361,1141,1142,1695)
   (364,365,366,898)(367,770,622,1179)(368,1375,1275,1487)(370,804,617,800)
   (374,1721,1642,494)(378,645,1204,1310)(386,959,1356,1122)(392,472,487,488)
   (393,1640,509,631)(394,1435,1218,1132)(395,1669,406,407)(396,1654,1110,956)
   (397,441,442,443)(398,740,739,1519)(399,1637,1372,1371)(401,1582,1459,1133)
   (404,405,470,1614)(408,605,1193,1460)(409,1468,1527,1740)(410,903,694,411)
   (412,615,1390,1577)(413,1414,1492,1485)(415,859,1121,1010)(417,430,1692,566)
   (418,554,819,981)(419,1044,1279,1373)(420,437,1112,1111)(421,1600,1745,525)
   (422,1442,489,423)(424,1659,1530,1531)(425,428,427,426)(431,982,1161,895)
   (434,1047,1628,1645)(435,1080,1613,1518)(444,1030,1029,1638)
   (446,1583,1109,447)(448,1388,1337,467)(449,902,1196,901)(450,717,961,841)
   (451,475,1667,1259)(453,1014,947,1733)(454,1543,1325,1144)(456,1174,1457,499)
   (457,923,760,823)(459,1319,993,907)(461,516,1306,1265)(468,469,1349,1350)
   (473,1660,1448,474)(476,644,1534,477)(479,544,557,558)(480,1013,580,1164)
   (482,1128,745,1668)(483,1160,1635,1673)(484,1211,1363,1755)
   (486,1663,1382,1130)(490,491,974,1627)(492,996,1262,1661)(496,850,1391,565)
   (498,1185,1242,782)(500,1449,1737,1404)(502,958,1227,1358)(505,1655,731,730)
   (514,529,1623,1470)(515,1420,904,611)(518,613,1062,1334)(519,1063,940,813)
   (526,1056,1625,933)(528,586,700,1557)(534,1489,1665,564)(535,1512,1562,1666)
   (536,867)(542,552,642,951)(543,1679,1399,603)(545,1290,1291,546)
   (550,1089,1424,1048)(556,1105,1644,1608)(559,560,980,908)(561,562,1314,815)
   (567,1634,648,949)(568,1326,1228,569)(570,876,1495,842)(571,1419,1000,1001)
   (572,1431,1726,1657)(573,574,1256,1352)(575,1011,1017,927)(581,827)
   (582,1316,824,809)(588,1016,681,680)(589,1254,1305,1718)(590,1232,937,1117)
   (591,922,1082,1216)(592,695,1386,593)(595,1701)(596,1137)(597,620,897,905)
   (598,825,826,801)(599,618)(601,1327,1240,1578)(604,1057,1696,1281)
   (607,1749,769,1436)(609,1639,1620,1083)(614,1118,1708,843)(619,919,628,768)
   (621,1520,1686,653)(624,1548,1570,1099)(625,884)(629,1393,1387,1354)
   (632,1253,844,652)(638,1486,1652,702)(639,941)(643,1564,1493,703)
   (646,1466,676,1515)(649,1671,1458,1732)(651,758,808,794)(656,1188,875,1170)
   (658,1312,1585,786)(660,1504,666,1113)(661,1198,1072,1203)(667,706,705,836)
   (668,896,1396,669)(670,1159,1746,1398)(671,1739,1123,1715)
   (672,1234,1703,1425)(674,1229,1162,1410)(679,1210,931,1119)
   (682,926,1024,1025)(683,1330,1478,1699)(685,686,1407,1406)(687,688,1453,1343)
   (690,1194,1416,1437)(691,1693,1576,692)(693,1647,1571,975)(698,888,1127,1651)
   (701,1474,1005,935)(704,846,1219,733)(708,711,710,709)(715,1455,1619,1754)
   (719,868,900,720)(721,1574,1624,1452)(723,1496,1572,1552)(724,732,1277,1626)
   (728,1434,1586,1609)(734,862,1694,1554)(737,738,1015,818)(741,1722,1674,742)
   (743,1664,1140,1556)(744,1046,1469,1573)(749,874,1444,1189)
   (751,1064,1295,1034)(752,1368,1367,1084)(753,1077,1621,954)
   (761,1381,925,1145)(766,1222,1131,1076)(771,1267,1632,1153)
   (772,1235,1191,1587)(773,1636,1192,1104)(774,877)(776,987)(777,1070,1532,778)
   (779,1276,1020,945)(780,942)(781,999,1697,1682)(784,1059,1725,1729)
   (788,1067,1068,833)(789,1677,1418,1685)(792,1035,847,988)(805,831)
   (810,1422,1580,854)(817,822,1054,971)(821,1584,1263,1264)(828,829,852,920)
   (838,1691,1270,1269)(845,1028,1231,1719)(848,1384,1498,1481)
   (851,1643,1351,970)(855,1400,1735,1467)(856,1041,1377,1378)(857,990,989,1154)
   (861,1357,994,1681)(869,1166,1687,1597)(870,1675,1752,1261)
   (872,1456,1428,1426)(879,1108,1098,892)(882,1510,1727,1517)
   (883,1566,1689,1004)(893,1321,1320,1558)(894,1335,1750,1683)
   (909,1454,910,1065)(911,1086,1591,1395)(913,1616,1051,1052)(914,985,984,983)
   (921,1340,1341,1342)(930,1055,1439,1612)(934,1106,1094,1567)
   (946,1073,1258,1124)(952,1441,1079,1243)(955,1366,1610,1589)
   (964,1136,1544,1257)(969,997,1723,1175)(972,1180,1658,973)(977,978,1096,1097)
   (991,1251,1103,1250)(1003,1433,1724,1328)(1026,1027,1167,1345)
   (1031,1032,1239,1302)(1033,1237,1271,1338)(1037,1516,1214,1078)
   (1039,1646,1274,1430)(1058,1208,1369,1248)(1060,1061,1712,1370)
   (1074,1308,1151,1656)(1081,1297,1296,1592)(1100,1603,1604,1101)
   (1115,1149,1182,1163)(1134,1147,1157,1511)(1138,1601,1500,1497)
   (1143,1479,1716,1488)(1148,1293,1294,1156)(1150,1680,1494,1303)
   (1155,1547,1462,1615)(1165,1549,1641,1560)(1168,1553,1292,1412)
   (1173,1590,1734,1649)(1181,1607,1676,1336)(1187,1317,1206,1233)
   (1225,1226,1324,1323)(1238,1246,1397,1593)(1249,1355,1720,1252)
   (1260,1529,1581,1471)(1266,1747,1579,1653)(1268,1389,1482,1606)
   (1273,1540,1283,1617)(1278,1629,1521,1522)(1284,1528,1333,1332)
   (1285,1286,1713,1526)(1289,1605,1618,1563)(1298,1475,1300,1301)
   (1304,1599,1541,1598)(1344,1508,1575,1401)(1364,1365,1539,1538)
   (1376,1483,1561,1429)(1403,1463,1738,1748)(1413,1736,1509,1514)
   (1417,1438,1569,1588)(1465,1536,1537,1690)(1507,1535,1688,1709) #CAST S
    ;
  simp:=SubStructure(S,a,#TODO CLOSURE
    b);
  simp.Order:=17971200;
  #   Presentation for Tits on a,b taken from B'ham Atlas 18/2/04 
  F:=SubGroup(x,y,[x^2,y^3,(x*y)^13,Tuple([x,y])^5,Tuple([x,y*x*y])
   ^4,(x*y*x*y*x*y*x*y*x*y^-1)^6]);
  phi:=GroupHomomorphismByImages(F,simp,
    a,b);
  soc:=Socle(group);
  aut:=Index(group,soc);
  if Print > 1 then
    Print("group is 2F4(2)':%o\n",aut);
  fi;
  # =v= MULTIASSIGN =v=
  gb:=get_standard_gens_tits@(soc);
  ga:=gb.val1;
  gb:=gb.val2;
  # =^= MULTIASSIGN =^=
  soc:=SubStructure(soc,ga,#TODO CLOSURE
    gb);
  soc.Order:=17971200;
  newgens:=[ga,gb];
  for g in Generators(group) do
    if not g in SubStructure(group,newgens) then
      Add(newgens,g);
    fi;
  od;
  group:=SubStructure(group,newgens);
  atits:=SubStructure(S,a,#TODO CLOSURE
    b,c);
  ims:=[a,b];
  homom:=GroupHomomorphismByImages(soc,simp,
    GeneratorsOfGroup(soc),ims);
  for i in [Ngens(soc)+1..Ngens(group)] do
    g:=group.i;
    CG:=atits;
    ce:=One(atits);
    for j in [1..2] do
      # =v= MULTIASSIGN =v=
      h:=IsConjugate(CG,simp.j^ce,homom(soc.j^g));
      isc:=h.val1;
      h:=h.val2;
      # =^= MULTIASSIGN =^=
      if not isc then
        Error("Conjugation error in Aut(twf42')");
      fi;
      CG:=Centraliser(CG,homom(soc.j^g));
      ce:=ce*h;
    od;
    Add(ims,ce);
  od;
  newgens:=ims;
  for g in Generators(atits) do
    if not g in SubStructure(atits,ims) then
      Add(ims,g);
    fi;
  od;
  atits:=SubStructure(S,ims);
  homom:=GroupHomomorphismByImages(group,atits,
    GeneratorsOfGroup(group),newgens);
  maximals:=[];
  if not max then
    return rec(val1:=homom,
      val2:=atits,
      val3:=maximals,
      val4:=F,
      val5:=phi);
  fi;
  #  
  #  Maximal subgroups from Birmingham web page.
  #  If their list is complete then all the subgroups below are
  #  maximal subgroups and give one from each conjugacy class
  #  of maximal subgroups.
  
  #   maximals common to both auts first 
  #   2.[2^8].5.4 - point stabilizer
  M:=BasicStabilizer(simp,2);
  M.Order:=10240;
  Add(maximals,M);
  #   L(2,25)
  M:=SubStructure(simp,a*b^-1*a*b*a*b*a*b*a*b^-1*a*b*a*b*a*b*a*b^-1,#TODO 
   CLOSURE
    a*b*a*b*a*b^-1*a*b^-1*a*b^-1*a*b*a*b^-1*a*b^-1*a*b*a*b*a*b^-1*a*b^-1);
  M.Order:=7800;
  Add(maximals,M);
  #   2^2.[2^8].S3
  M:=SubStructure(simp,
   b*a*b*a*b^-1*a*b*a*b*a*b*a*b^-1*a*b^-1*a*b^-1*a*b^-1*a*b*a*b^-1*a*b^-1*a*b*a*\
b^-1,#TODO CLOSURE

       a*b*a*b*a*b^-1*a*b^-1*a*b^-1*a*b^-1*a*b*a*b^-1*a*b^-1*a*b^-1*a*b*a*b*a*b^\
-1*a*b*a);

     M.Order:=6144;
  Add(maximals,M);
  #   5^2:4A4
  M:=SubStructure(simp,
   b*a*b^-1*a*b^-1*a*b*a*b*a*b^-1*a*b*a*b^-1*a*b^-1*a*b*a*b*a*b^-1,#TODO 
   CLOSURE
    a*b^-1*a*b*a*b*a*b*a*b^-1*a*b*a*b*a*b^-1*a*b^-1*a*b^-1*a*b*a);
  M.Order:=1200;
  Add(maximals,M);
  if aut=1 then
    #   two copies of L(3,3):2
    M:=SubStructure(simp,b*a*b*a*b^-1*a*b^-1*a*b*a*b*a*b^-1*a*b^-1*a,#TODO 
     CLOSURE
      b^-1*a*b*a*b*a*b^-1*a*b^-1*a*b*a*b^-1*a);
    M.Order:=11232;
    Add(maximals,M);
    Add(maximals,M^c);
    #   two copies of A6.2^2
    M:=SubStructure(simp,b*a*b^-1*a*b^-1*a*b*a*b*a*b^-1,#TODO CLOSURE
      a*b^-1*a*b^-1*a*b^-1*a*b^-1*a*b*a*b^-1*a*b^-1*a*b);
    M.Order:=1440;
    Add(maximals,M);
    Add(maximals,M^c);
  else
    Assert(1,aut=2);
    #   2 classes of novelties from within the L(3,3):2's
    #   3^(1+2):8:2, intersection with simp is 3^(1+2):2^2.2
    M:=SubStructure(simp,
     a*b*a*b^-1*a*b*a*b*a*b*a*b*a*b^-1*a*b*a*b*a*b^-1*a*b*a*b*a,#TODO CLOSURE
      a*b*a*b*a*b*a*b^-1*a*b^-1*a*b*a*b^-1*a*b^-1*a*b*a*b^-1*a*b^-1*a*b^-1*a*b*a\
*b*a*b*a*b*a*b*a*b);

         M.Order:=216;
    Add(maximals,M);
    #   13:12, intersection with simp is 13:6
    M:=SubStructure(simp,
     b*a*b*a*b^-1*a*b*a*b*a*b^-1*a*b*a*b*a*b^-1*a*b*a*b*a*b^-1*a*b^-1*a*b^-1*a*b\
*a*b^-1*a*b^-1*a*b^-1*a*b^-1*a*b*a*b,#TODO CLOSURE

           b*a*b*a*b*a*b*a*b*a*b^-1*a*b*a*b*a*b*a*b*a*b^-1*a*b*a*b*a*b*a*b^-1*a*\
b*a*b*a*b*a*b^-1*a*b*a*b^-1*a*b^-1*a*b*a*b);

         M.Order:=78;
    Add(maximals,M);
  fi;
  return rec(val1:=homom,
    val2:=atits,
    val3:=maximals,
    val4:=F,
    val5:=phi);
end);


